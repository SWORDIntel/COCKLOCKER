# CockLocker - Hardened Cockpit Configuration
# APT-level threat mitigation configuration

[WebService]
# Origins and security headers
Origins = https://127.0.0.1 https://localhost
ProtocolHeader = X-Forwarded-Proto
LoginTitle = Hardened Cockpit (CockLocker)

# Connection limits to prevent DoS
MaxStartups = 10
MaxSessions = 10

# Timeouts (aggressive for security)
IdleTimeout = 10
LoginTimeout = 30

# Force HTTPS
AllowUnencrypted = false
UrlRoot = /

[Session]
# Session security
IdleTimeout = 600
Banner = /etc/cockpit/issue

# Restrict session capabilities
Shell = /bin/bash
SSHLogin = false

[Log]
# Comprehensive logging for threat detection
Fatal = /var/log/cockpit-hardened/fatal.log
Level = info

[OAuth]
# OAuth configuration (if needed)
# URL =
# ErrorParam =

[BasicAuth]
# Restrict authentication methods
Action = none

[Negotiate]
# Kerberos/GSSAPI (disable if not needed)
Command = none
